---
// src/pages/index.astro
import '../styles/global.css';
import Layout from '../layouts/Layout.astro';
import { getGithubRepos } from '../lib/github';
import { getZennArticles } from '../lib/zenn';

// データを取得
const repos = await getGithubRepos();
const articles = await getZennArticles();

// プロフィール情報（ここを書き換えてください）
const profile = {
  name: "Kinn00kinn", // あなたの名前
  role: "KOSEN Advanced Course Student",
  bio: "情報専攻の高専専攻科生。Web開発とインフラに興味があります。",
  githubUrl: "https://github.com/kinn00kinn",
  zennUrl: "https://zenn.dev/kinn00kinn",
};
---

<Layout title={`${profile.name} - Portfolio`}>
  
  {/* ヘッダーセクション */}
  <header class="mb-16 animate-fade-in-down">
    <h1 class="text-4xl md:text-5xl font-bold text-white mb-4 tracking-tight">
      {profile.name}
    </h1>
    <p class="text-xl text-cyan-400 font-medium mb-4">{profile.role}</p>
    <p class="text-slate-400 max-w-2xl leading-relaxed mb-6">
      {profile.bio}
    </p>
    
    <div class="flex gap-4">
      <a href={profile.githubUrl} target="_blank" class="px-5 py-2 rounded-full bg-slate-800 hover:bg-slate-700 text-white font-medium transition flex items-center gap-2">
        <span class="i-simple-icons-github"></span> GitHub
      </a>
      <a href={profile.zennUrl} target="_blank" class="px-5 py-2 rounded-full bg-[#3EA8FF]/20 text-[#3EA8FF] hover:bg-[#3EA8FF]/30 font-medium transition flex items-center gap-2">
        Zenn
      </a>
    </div>
  </header>

  <main class="space-y-20">
    
    {/* GitHub Projects Section */}
    <section>
      <div class="flex items-center justify-between mb-8">
        <h2 class="text-2xl font-bold text-white flex items-center gap-2">
          <span class="w-2 h-8 bg-green-500 rounded-full inline-block"></span>
          Projects
        </h2>
        <a href={profile.githubUrl} class="text-sm text-slate-500 hover:text-white transition">View all →</a>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {repos.map((repo) => (
          <a 
            href={repo.url} 
            target="_blank" 
            class="group p-6 bg-slate-900 border border-slate-800 rounded-xl hover:border-slate-600 hover:shadow-xl hover:shadow-cyan-900/10 transition duration-300 flex flex-col"
          >
            <div class="flex justify-between items-start mb-4">
              <h3 class="font-bold text-lg text-slate-100 group-hover:text-cyan-400 transition">{repo.name}</h3>
              <span class="text-xs font-mono bg-slate-800 text-slate-400 px-2 py-1 rounded border border-slate-700">Public</span>
            </div>
            <p class="text-sm text-slate-400 mb-6 flex-grow line-clamp-3">{repo.description}</p>
            
            <div class="flex items-center gap-4 text-xs text-slate-500 font-mono mt-auto">
              {repo.primaryLanguage && (
                <div class="flex items-center gap-1.5">
                  <span class="w-3 h-3 rounded-full" style={{ backgroundColor: repo.primaryLanguage.color }}></span>
                  {repo.primaryLanguage.name}
                </div>
              )}
              <div class="flex items-center gap-1">
                ★ {repo.stargazerCount}
              </div>
            </div>
          </a>
        ))}
      </div>
    </section>

    {/* Zenn Articles Section */}
    <section>
      <div class="flex items-center justify-between mb-8">
        <h2 class="text-2xl font-bold text-white flex items-center gap-2">
          <span class="w-2 h-8 bg-[#3EA8FF] rounded-full inline-block"></span>
          Articles
        </h2>
        <a href={profile.zennUrl} class="text-sm text-slate-500 hover:text-white transition">View all →</a>
      </div>

      <div class="space-y-4">
        {articles.slice(0, 5).map((article) => (
          <a 
            href={article.link} 
            target="_blank"
            class="block p-5 rounded-lg bg-slate-900/50 hover:bg-slate-800 border border-slate-800/50 hover:border-slate-700 transition group"
          >
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-2">
              <h3 class="font-medium text-slate-200 group-hover:text-[#3EA8FF] transition text-lg">
                {article.title}
              </h3>
              <time class="text-sm text-slate-500 font-mono whitespace-nowrap">{article.pubDate}</time>
            </div>
          </a>
        ))}
      </div>
    </section>

  </main>
  
  <footer class="mt-20 pt-10 border-t border-slate-800 text-center text-slate-600 text-sm">
    <p>&copy; {new Date().getFullYear()} {profile.name}. Built with Astro & Cloudflare Pages.</p>
  </footer>

</Layout>